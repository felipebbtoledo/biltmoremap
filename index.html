<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="HandheldFriendly" content="true">
    <title>The Phil Tibi Group</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@600;700;900&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="data:,">
    <!-- begin Widget Tracker Code -->
    <script>
    (function(w,i,d,g,e,t){w["WidgetTrackerObject"]=g;(w[g]=w[g]||function()
    {(w[g].q=w[g].q||[]).push(arguments);}),(w[g].ds=1*new Date());(e="script"),
        (t=d.createElement(e)),(e=d.getElementsByTagName(e)[0]);t.async=1;t.src=i;
        e.parentNode.insertBefore(t,e);})
    (window,"https://widgetbe.com/agent",document,"widgetTracker");
    window.widgetTracker("create", "WT-XFDAITAW");
    window.widgetTracker("send", "pageview");
    </script>
    <!-- end Widget Tracker Code -->
</head>
<body>
<div id="searchCommunitiesFilter">
    <select name="searchCommunitiesFilter" class="selectpicker" data-live-search="true" data-width="100%">
        <!--                                    <option>Communities</option>-->
    </select>
</div>
<main>
    <div id="google-sheets"></div>
    <div class="aside-panel collapsed">

        <!-- HEADER -->
        <div class="position-relative">
            <div class="open-close-area" id="open-close-area">
                <a href="#"><i class="fa fa-angle-left"></i></a>
            </div>
            <div class="header">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-6 col-xl-7">
                            <div class="logo">
                                <img src="img/ptg-logo.png" alt="The Phil Tibi Group">
                            </div>
                        </div>
                        <div class="col-lg-6 col-xl-5">
                            <div class="form-group m-0">
                                <select name="CommunitiesList" id="CommunitiesList" class="selectpicker" data-live-search="true" data-width="100%">
                                    <!--                                    <option>Communities</option>-->
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /HEADER -->

        <!-- CONTENT AREA -->
        <div class="content-area">
            <div class="helping-center-line">
                <div class="container">
                    <div class="d-flex align-items-center justify-content-between">
                        <div>602-320-1000</div>
                        <img src="img/north-and-co.png" alt="North&Co. - Real Estate by Trade" style="max-height:65px">
                        <img src="img/fh-logo.png" alt="Fair Housing - Equal Housing Opportunity" style="max-height:65px">
                        <!--                        <div class="social-icons">-->
                        <!--                            <a href="" class="facebook"><i class="fa fa-facebook"></i></a>-->
                        <!--                            <a href="" class="linkedin"><i class="fa fa-linkedin"></i></a>-->
                        <!--                        </div>-->
                    </div>
                </div>
            </div>
            <!-- PAGE -->
            <div class="page-section">
                <div class="container">
                    <h5 class="community-name"></h5>
                    <ul class="community-links"></ul>
                    <h6 class="community-summary-title">Community Summary</h6>
                    <p class="community-summary"></p>
                    <h6 class="community-details-title">Community Details</h6>
                    <div class="community-details"></div>
                    <h6 class="community-additional-info-title">Community Additional Info</h6>
                    <p class="community-additional-info"></p>
                    <!-- Follow your favorite properties form -->
                    <form class="gform" data-email="phil@thetibigroup.com" method="POST"
                          action="https://script.google.com/macros/s/AKfycby1p4N3NGhVaCkzjjtH4UOlvIAStZ3yWtHvKd3EqmtpB3HrJuEfrw1yM_ozXtEAlkGF/exec">
                        <h6>Follow your favorite properties</h6>
                        <p>Be notified and kept up to date the moment a property within this Community becomes available or any status changes.</p>
                        <div class="row row-inputs">
                            <div class="col-sm-12 col-md-4">
                                <div class="form-group">
                                    <label for="name">Name</label>
                                    <input type="text" class="form-control" id="name" name="name" placeholder="Name" value="" autocomplete="off" required>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-4 px-lg-0">
                                <div class="form-group">
                                    <label for="phone">Phone Number</label>
                                    <input type="text" class="form-control" id="phone" name="phone" placeholder="Phone Number" value="" autocomplete="off" minlength="12" required>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-4">
                                <div class="form-group" error-message="Please enter a valid email">
                                    <label for="email">Email</label>
                                    <input type="email" class="form-control" id="email" name="email" placeholder="Email" value="" autocomplete="off" onblur="checkEmail(this)" required>
                                </div>
                            </div>
                        </div>
                        <div class="row row-inputs clone-me">
                            <div class="col-sm-12 col-md-6 pr-lg-2">
                                <div class="form-group has-icon has-label">
                                    <label for="notify_me_based_on1">Notify me based on</label>
                                    <!--                                    <input type="text" class="form-control ui-autocomplete-input" id="notifyMeLocation" name="address" placeholder="Community" value="" autocomplete="off" required>-->
                                    <select class="form-control" id="notify_me_based_on1" required>
                                    </select>
                                    <!--                                    <span class="form-control-icon"><i class="fa fa-map-marker"></i></span>-->
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 pl-lg-2">
                                <div class="form-group">
                                    <label for="property_for1">Property For</label>
                                    <select class="form-control" id="property_for1" required>
                                        <option value="" disabled selected>Select</option>
                                        <option value="for sale">For sale</option>
                                        <option value="for lease">For lease</option>
                                        <option value="coming soon">Coming soon</option>
                                        <option value="recently sold">Recently sold</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="container-fluid">
                                <div class="d-flex justify-content-between align-items-center">
                                    <a href="javascript:void(0)" class="other-communities-link"><i class="fa fa-plus-circle"></i> Add other communities to track</a>
                                    <button type="submit" id="formFollowFavoriteSubmit" class="btn btn-submit pull-right">Submit</button>
                                </div>
                            </div>
                        </div>

                        <!-- Customise the Thankyou Message People See when they submit the form: -->
                        <div class="thankyou_message popup">
                            <div class="container">
                                <h6>Thanks for contacting us!</h6>
                                <p>We will get back to you soon.</p>
                            </div>
                        </div>
                        <input type="hidden" name="tags" value="">
                    </form>

                    <hr class="page-divider half transparent">
                    <div style="color: gray;font-size: 12px;margin-top: 15px;">This interactive Biltmore Map artwork and software application is Trademark Registered and
                        is the sole property of Phil Tibi PLLC. Any unauthorized replication, use, or distribution is strictly prohibited.</div>
                </div>
            </div>
            <!-- /PAGE -->
        </div>
        <!-- /CONTENT AREA -->
    </div>
    <svg width="100%" height="100%" viewBox="0 0 1650 1275">
        <filter id="neon">
            <feFlood flood-color="rgb(255,255,128)" flood-opacity="0.5" in="SourceGraphic" />
            <feComposite operator="in" in2="SourceGraphic" />
            <feGaussianBlur stdDeviation="10" />
            <feComponentTransfer result="glow1">
                <feFuncA type="linear" slope="4" intercept="0" />
            </feComponentTransfer>
            <feMerge>
                <feMergeNode in="glow1" />
                <feMergeNode in="SourceGraphic" />
            </feMerge>
        </filter>
        <mask>
            <rect width="100%" height="100%" fill="white" />
        </mask>
        <image href="img/map-january-2023.jpg" xlink:href="img/map-january-2023.jpg" x="0" y="0" height="100%" width="100%" preserveAspectRatio="none" />
        <!-- BiltmoreSquare -->
        <rect id="BiltmoreSquare" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow left" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#BiltmoreSquare">Community Info</a>
                        <a class="btn btn-green" href="#BiltmoreSquare">For sale</a>
                        <a class="btn btn-blue" href="#BiltmoreSquare">For lease</a>
                        <a class="btn btn-orange" href="#BiltmoreSquare">Coming soon</a>
                        <a class="btn btn-purple" href="#BiltmoreSquare">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreSquare" xlink:href="#BiltmoreSquare">
            <polygon points="1,396,21,367,31,367,50,372,50,357,71,331,79,326,122,344,198,340,215,344,227,332,235,328,279,342,279,380,291,385,289,421,228,446,195,433,190,425,174,417,128,418,117,404,104,417,55,412,46,430,1,421"
                     filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /BiltmoreSquare -->
        <!-- 2211 -->
        <rect id="2211" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow down" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#2211" xlink:href="#2211">
            <polygon points="470,1107,469,1069,495,1072,499,1056,565,1054,575,1062,594,1062,607,1091,620,1111,617,1142,555,1143,553,1172,530,1169,527,1204,508,1187,501,1161,490,1126,482,1111"
            filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /2211 -->
        <!-- BiltmoreCourts -->
        <rect id="BiltmoreCourtsIi" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow left" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="">Community Info</a>
                        <a class="btn btn-green" href="">For sale</a>
                        <a class="btn btn-blue" href="">For lease</a>
                        <a class="btn btn-orange" href="">Coming soon</a>
                        <a class="btn btn-purple" href="">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreCourtsIi" xlink:href="#BiltmoreCourtsIi">
            <polygon points="317,429,302,417,302,401,310,393,301,391,301,378,311,364,336,349,346,356,413,350,425,355,432,346,445,359,445,415,431,429,399,423,359,422"
            filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /BiltmoreCourts -->
        <!-- BiltmoreHotelVillas -->
        <rect id="BiltmoreHotelVillas" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow left" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="">Community Info</a>
                        <a class="btn btn-green" href="">For sale</a>
                        <a class="btn btn-blue" href="">For lease</a>
                        <a class="btn btn-orange" href="">Coming soon</a>
                        <a class="btn btn-purple" href="">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreHotelVillas" xlink:href="#BiltmoreHotelVillas">
            <polygon points="540,444,507,447,499,439,489,440,480,431,472,421,467,411,466,401,469,391,473,383,486,370,509,369,520,360,528,364,600,360,600,364,609,357,627,364,636,385,626,386,625,404,620,395,609,391,597,401,572,401,556,407,553,418,552,437,543,436"
            filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /BiltmoreHotelVillas -->
        <!-- Biltmore Gates -->
        <rect id="BiltmoreGates" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="">Community Info</a>
                        <a class="btn btn-green" href="">For sale</a>
                        <a class="btn btn-blue" href="">For lease</a>
                        <a class="btn btn-orange" href="">Coming soon</a>
                        <a class="btn btn-purple" href="">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreGates" xlink:href="#BiltmoreGates">
            <polygon points="829,302,1023,294,1014,286,1017,277,1005,264,999,254,999,205,896,207,897,268,890,271,888,255,869,227,829,236" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Biltmore Gates -->
        <!-- BiltmoreHillsideVillas -->
        <rect id="BiltmoreHillsideVillas" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreHillsideVillas" xlink:href="#BiltmoreHillsideVillas">
            <polygon points="1008,211,1094,162,1209,162,1285,207,1246,223,1216,235,1180,240,1126,243,1079,243,1014,235" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /BiltmoreHillsideVillas -->
        <!-- Mountain Estates -->
        <rect id="BiltmoreMountainEstates" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow up" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreMountainEstates" xlink:href="#BiltmoreMountainEstates">
            <polygon points="741,190,773,144,859,103,868,83,992,80,1052,100,1062,122,1068,163,1002,138,922,198,884,182,871,203" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Mountain Estates -->
        <!-- LincolnHills -->
        <rect id="LincolnHills" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow up" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#LincolnHills" xlink:href="#LincolnHills">
            <polygon points="1334,127,1352,109,1463,111,1520,131,1512,176,1461,162,1425,169,1404,169,1371,165,1337,144" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /LincolnHills -->
        <!-- Biltmore Greens -->
        <rect id="BiltmoreGreens" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreGreens" xlink:href="#BiltmoreGreens">
            <polygon points="1213,370,1227,363,1253,356,1253,335,1251,323,1253,297,1225,294,1228,280,1216,264,1192,272,1178,290,1183,306,1154,306,1170,297,1167,277,1152,262,1136,268,1123,284,1119,299,1110,294,1113,280,1103,270,1082,264,1071,281,1071,300,1063,310,1060,363" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Biltmore Greens -->
        <!-- Alta Vista Park -->
        <rect id="AltaVistaPark" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#AltaVistaPark" xlink:href="#AltaVistaPark">
            <polygon points="1231,383,1237,377,1254,384,1256,369,1263,368,1263,349,1283,337,1283,324,1308,318,1333,324,1334,350,1340,350,1339,374,1348,369,1378,381,1378,407,1353,423,1359,431,1358,447,1378,442,1393,445,1401,455,1399,464,1243,444" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Alta Vista Park -->
        <!-- BiltmoreShores -->
        <rect id="BiltmoreShores" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreShores" xlink:href="#BiltmoreShores">
            <polygon points="1063,600,1082,611,1092,623,1092,630,1104,629,1126,642,1141,649,1174,649,1176,670,1197,681,1209,694,1219,706,1225,703,1240,715,1241,726,1165,726,1164,748,1111,750,1107,737,1084,734,1052,731,1039,729,1034,715,1031,705,1027,693,1023,684,1015,674,1011,662,1014,652,1025,642,1034,635,1037,624,1037,614,1050,611" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /BiltmoreShores -->
        <!-- VillageOnTheLakes -->
        <rect id="VillageOnTheLakes" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#VillageOnTheLakes" xlink:href="#VillageOnTheLakes">
            <polygon points="1310,740,1320,761,1320,780,1329,795,1329,811,1323,817,1321,807,1205,807,1202,815,1152,818,1116,804,1116,788,1126,772,1152,766,1165,788,1165,725,1272,725,1270,773,1278,764,1288,747" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /VillageOnTheLakes -->
        <!-- Meridian -->
        <rect id="Meridian" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#Meridian" xlink:href="#Meridian">
            <polygon points="1304,947,1314,912,1340,877,1345,835,1320,810,1203,809,1193,819,1139,815,1142,864,1157,890,1190,893,1209,918,1206,944" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Meridian -->
        <!-- BiltmoreTerrace -->
        <rect id="BiltmoreTerrace" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreTerrace" xlink:href="#BiltmoreTerrace">
            <polygon points="1129,844,1145,875,1148,898,1186,894,1206,923,1202,946,1183,948,1183,962,1148,964,1082,974,1079,992,1062,987,1024,954,1023,906,1044,893,1049,871,1074,865,1088,844" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /BiltmoreTerrace -->
        <!-- Biltmore Circle Estates -->
        <rect id="BiltmoreCircleEstates" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow down" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreCircleEstates" xlink:href="#BiltmoreCircleEstates">
            <polygon points="655,790,716,839,795,849,797,818,881,804,884,826,907,791,916,759,916,727,910,696,883,645,910,628,955,623,986,644,980,668,990,696,1004,727,1005,762,999,810,983,845,961,880,938,904,903,922,846,938,830,919,816,936,789,936,762,939,725,928,677,918,611,889,588,822,565,817,563,778,508,765,467,726,394,702,397,613,509,619,527,686,585,717,617,749" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Biltmore Circle Estates -->
        <!-- Two Biltmore Estates -->
        <rect id="TwoBiltmoreEstates" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow left" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#TwoBiltmoreEstates" xlink:href="#TwoBiltmoreEstates">
            <polygon points="558,541,568,519,616,508,635,519,661,515,662,498,684,485,703,489,734,511,773,554,818,591,852,624,887,672,904,718,907,763,885,807,883,796,795,815,791,840,748,836,719,828,696,815,677,798,639,757,610,722,582,702,552,686,531,667,525,643,530,607,525,576,540,563,558,560" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Two Biltmore Estates -->
        <!-- Biltmore Fairway Lodge -->
        <rect id="BiltmoreFairwayLodge" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow right" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#BiltmoreFairwayLodge" xlink:href="#BiltmoreFairwayLodge">
            <polygon points="985,637,953,616,902,602,833,583,763,536,767,513,773,504,773,482,799,462,867,479,880,491,896,500,915,493,964,522,976,562,1006,580,1005,624" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Biltmore Fairway Lodge -->
        <!-- Hillstone -->
        <!--        <a href=" xlink:href="#Hillstone">-->
        <!--            <polygon points="834,1025,884,1021,920,1031,932,1054,929,1078,851,1082,830,1047" filter="url(#neon)" fill="transparent"/>-->
        <!--        </a>-->
        <!-- /Hillstone -->
        <!-- Optima Towers -->
        <rect id="Optima" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow down" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>

                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#Optima" xlink:href="#Optima">
            <polygon points="528,1210,533,1229,531,1254,539,1274,671,1274,676,1233,668,1206,651,1172,636,1172,636,1145,556,1146,555,1169,534,1168" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Optima Towers -->
        <!-- Esplanade Place -->
        <rect id="EsplanadePlace" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow down" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#EsplanadePlace" xlink:href="#EsplanadePlace">
            <polygon points="668,1198,673,1139,721,1137,724,1128,747,1129,760,1148,839,1145,839,1180,856,1207,851,1274,687,1274,674,1255,676,1230,671,1223" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Esplanade Place -->
        <!--        <a href=" xlink:href="#51">-->
        <!--            <polygon points="60,971,1,971,1,825,31,825,63,872,63,893,69,888,123,887,132,895,136,907,135,922,122,930,71,932,63,926" filter="url(#neon)" fill="transparent"/>-->
        <!--        </a>-->
        <!-- TheCloisters -->
        <rect id="TheCloisters" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow down" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#TheCloisters" xlink:href="#TheCloisters">
            <polygon points="85,850,109,885,139,894,142,920,187,914,193,906,327,898,348,890,361,878,403,878,429,876,472,878,507,882,555,882,552,859,601,860,582,825,563,817,559,783,552,774,501,766,466,769,439,729,371,734,371,779,311,783,308,805,278,789,265,786,219,795,190,805,176,795,154,791,125,789,112,792,95,821,95,847" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /TheCloisters -->
        <!-- Taliverde -->
        <rect id="Taliverde" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow left" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#Taliverde" xlink:href="#Taliverde">
            <polygon points="1,638,14,635,26,643,44,641,55,632,79,628,116,619,130,647,152,648,165,657,180,656,196,647,215,654,267,657,281,670,190,670,189,730,168,723,133,727,116,708,84,689,8,707,2,689" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /Taliverde -->
        <!-- HeightsOfTheBiltmore -->
        <rect id="HeightsOfTheBiltmore" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow left" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#HeightsOfTheBiltmore" xlink:href="#HeightsOfTheBiltmore">
            <polygon points="17,519,38,517,99,513,103,567,90,580,65,625,45,634,28,640,15,629,0,631,1,522,14,530" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /HeightsOfTheBiltmore -->
        <!-- ColonyBiltmoreGreens -->
        <rect id="ColonyBiltmoreGreens" width="100%" height="100%" x="0" y="0" />
        <foreignObject width="100%" height="100%">
            <div class="popup arrow left" xmlns="http://www.w3.org/1999/xhtml">
                <div class="comm-info"></div>
                <div class="caption">
                    <div class="caption-title"></div>
                    <ul class="buttons">
                        <a class="btn btn-inverted" href="#communityinfo">Community Info</a>
                        <a class="btn btn-green" href="#forsale">For sale</a>
                        <a class="btn btn-blue" href="#forlease">For lease</a>
                        <a class="btn btn-orange" href="#comingsoon">Coming soon</a>
                        <a class="btn btn-purple" href="#recentlysold">Recently sold</a>
                    </ul>
                </div>
                <a class="close" href="#">
                    <span>&times;</span>
                </a>
            </div>
        </foreignObject>
        <a href="#ColonyBiltmoreGreens" xlink:href="#ColonyBiltmoreGreens">
            <polygon points="184,756,186,737,193,728,193,713,192,690,193,671,308,672,310,697,316,689,332,680,345,694,345,722,342,731,342,751,310,770,294,770,294,782,270,788,267,785,187,802,177,801,181,792,139,789,141,772,129,753,129,731,165,725" filter="url(#neon)" fill="transparent">
                <animate attributeType="CSS" attributeName="fill-opacity" values="0;0.3;0" dur="2s" repeatCount="indefinite"></animate>
            </polygon>
        </a>
        <!-- /ColonyBiltmoreGreens -->
    </svg>
</main>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
<!-- Submit the Form to Google Using "AJAX" -->
<!--<script data-cfasync="false" src="form-submission-handler.js"></script>-->
<!-- /Follow your favorite properties form -->
<script type="text/javascript">
    // Slideshow function
    var slideIndex = 1;

    // Next/previous controls
    function plusSlides(n) {
        showSlides(slideIndex += n);
    }

    // Thumbnail image controls
    function currentSlide(n) {
        showSlides(slideIndex = n);
    }

    function showSlides(n) {
        let i;
        let slides = document.getElementsByClassName("mySlides");
        if (n > slides.length) {slideIndex = 1}
        if (n < 1) {slideIndex = slides.length}
        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        slides[slideIndex-1].style.display = "block";
    }
    // End Slideshow function

    // BEGIN form-submission-handler.js
    // get all data in form and return object
    function getFormData(form) {
        var elements = form.elements;
        var honeypot;

        var fields = Object.keys(elements).filter(function(k) {
            if (elements[k].name === "honeypot") {
                honeypot = elements[k].value;
                return false;
            }
            return true;
        }).map(function(k) {
            if(elements[k].name !== undefined) {
                return elements[k].name;
                // special case for Edge's html collection
            }else if(elements[k].length > 0){
                return elements[k].item(0).name;
            }
        }).filter(function(item, pos, self) {
            return self.indexOf(item) == pos && item;
        });

        var formData = {};
        fields.forEach(function(name){
            var element = elements[name];

            // singular form elements just have one value
            formData[name] = element.value;

            // when our element has multiple items, get their values
            if (element.length) {
                var data = [];
                for (var i = 0; i < element.length; i++) {
                    var item = element.item(i);
                    if (item.checked || item.selected) {
                        data.push(item.value);
                    }
                }
                formData[name] = data.join(', ');
            }
        });

        // add form-specific values into the data
        formData.formDataNameOrder = JSON.stringify(fields);
        formData.formGoogleSheetName = form.dataset.sheet || "responses"; // default sheet name
        formData.formGoogleSendEmail
            = form.dataset.email || ""; // no email by default

        return {data: formData, honeypot: honeypot};
    }

    function handleFormSubmit(event) {  // handles form submit without any jquery
        // console.log("handleFormSubmit()");
        formSubmittedCounter++;
        accessControl(accessCounter, formSubmittedCounter);
        event.preventDefault();           // we are submitting via xhr below
        var form = event.target;

        // populate tags input hidden
        const tagsInputHidden = form.querySelector("input[name='tags']");
        form.querySelectorAll("select:not([name])").forEach((elm) => {
            // console.log('elm'+ elm + elm.value + 'tagsInputHidden' + tagsInputHidden.value);
            tagsInputHidden.value ? tagsInputHidden.value += ',' + elm.value : tagsInputHidden.value = elm.value;
        });

        var formData = getFormData(form);
        var data = formData.data;

        // If a honeypot field is filled, assume it was done so by a spam bot.
        if (formData.honeypot) {
            return false;
        }

        // disableAllButtons(form);
        var url = form.action;
        var xhr = new XMLHttpRequest();
        xhr.open('POST', url);
        // xhr.withCredentials = true;
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4 && xhr.status === 200) {
                form.reset();

                var formElements = form.querySelector(".form-elements")
                if (formElements) {
                    formElements.style.display = "none"; // hide form
                }
                // handle thank you message
                var thankYouMessage = form.querySelector(".thankyou_message");
                if (thankYouMessage) {
                    thankYouMessage.classList.add("sent");
                }
            }
        };
        // url encode form data for sending as post data
        var encoded = Object.keys(data).map(function(k) {
            return encodeURIComponent(k) + "=" + encodeURIComponent(data[k]);
        }).join('&');
        xhr.send(encoded);
    }

    function loaded() {
        // Onload, remove hash
        window.location.hash = '';
        // bind to the submit event of our form
        const forms = document.querySelectorAll("form.gform");
        for (var i = 0; i < forms.length; i++) {
            forms[i].addEventListener("submit", handleFormSubmit, false);
        }
        // Start glow effect with a delay
        setTimeout(startGlowEffect, 1500);
        function startGlowEffect() {
            const polygons = document.getElementsByTagName("polygon");
            for (var i = 0; i < polygons.length; i++) {
                polygons[i].setAttribute("fill", "white");
            }
        }
    };
    document.addEventListener("DOMContentLoaded", loaded, false);

    // function disableAllButtons(form) {
    //     var buttons = form.querySelectorAll("button");
    //     for (var i = 0; i < buttons.length; i++) {
    //         buttons[i].disabled = true;
    //     }
    // }
    // END form-submission-handler.js

    // email field validation
    function checkEmail(str) {
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        if(!re.test(str.value)){
            str.parentNode.classList.add('form-field-error');
        }
        else {
            if(str.parentNode.classList.contains('form-field-error'))
                str.parentNode.classList.remove('form-field-error');
        }
    }

    var asidePanel = document.querySelector('.aside-panel');
    var svgLinks = document.querySelectorAll('main > svg > a');
    var popupCloseLinks = document.querySelectorAll('.popup .close');
    var hash = window.location.hash;
    var hashValue = hash.split('#')[1];
    var openCloseArea = document.querySelector('.open-close-area');
    var popupButtons = document.querySelectorAll('.popup .buttons .btn');
    const searchCommunitiesFilter = document.querySelector('#searchCommunitiesFilter select[name="searchCommunitiesFilter"]');
    // Using localStorage
    var accessCounter = localStorage.getItem('ac') || 0;
    var formSubmittedCounter = localStorage.getItem('fs') || 0;

    function accessControl(accessCounter, formSubmittedCounter){
        accessCounter ++;
        console.log("accessCounter"+accessCounter + "formSubmittedCounter"+formSubmittedCounter);

        if(accessCounter > 2) {
            if(formSubmittedCounter > 0) {
                unblockPointerEvents();
                localStorage.setItem('fs', formSubmittedCounter);
            }
            else {
                alert('To continue using the Biltmore Interactive Map, please fill in the following form.');
                window.location.href='#capture';
                setTimeout(function() {
                    asidePanel.classList.remove('collapsed');
                    asidePanel.classList.add('favorite-properties');
                    document.querySelector('.aside-panel .page-section').style.opacity = '1';
                    mapCommunitySelected();
                    blockPointerEvents();
                } , 500 );
            }
        }

        localStorage.setItem('ac', accessCounter);
    }

    function blockPointerEvents () {
        document.querySelector('.aside-panel .header .dropdown.bootstrap-select').style.display = 'none';
        document.getElementById("searchCommunitiesFilter").style.display = 'none';
        if(document.documentElement.clientWidth > 1024) {
            document.querySelector('main > svg').style.opacity = '0.33';
        }
        document.querySelector('main > svg').style.pointerEvents = 'none';
        document.querySelector('.open-close-area').style.display = 'none';
    }

    function unblockPointerEvents () {
        if(document.querySelector('.aside-panel .header .dropdown.bootstrap-select[style*="display"]')){
            document.querySelector('.aside-panel .header .dropdown.bootstrap-select[style*="display"]').style.removeProperty('display');
        }
        document.querySelector('main > svg').removeAttribute('style');
        document.querySelector('.open-close-area').removeAttribute('style');
        document.getElementById("searchCommunitiesFilter").removeAttribute('style');
        asidePanel.classList.add('collapsed');
        asidePanel.classList.remove('favorite-properties');
    }

    document.addEventListener("DOMContentLoaded", function(event) {

        accessControl(accessCounter, formSubmittedCounter);

        // Search community filter
        function mobileSearchCommFilter() {
            document.querySelectorAll('main > svg > rect').forEach((comm, index) => {
                if(index == 0){
                    let firstChild = document.createElement('option');
                    firstChild.textContent = 'Search for a community';
                    firstChild.setAttribute('disabled','disabled');
                    firstChild.setAttribute('selected','selected');
                    firstChild.value = "";
                    searchCommunitiesFilter.appendChild(firstChild);
                }
                let newChild = document.createElement('option');
                let commId = comm.getAttribute('id');
                newChild.value = commId;
                newChild.textContent = commId.match(/[A-Z][a-z]+|[0-9]+/g).join(" ");
                // append the options
                searchCommunitiesFilter.appendChild(newChild);
            });
        }
        // setTimeout(function() { mobileSearchCommFilter(); }, 250);
        mobileSearchCommFilter();

        // Add other communities to track on mobile
        $(document).on('click', '.popup[style] .gform .other-communities-link', function (e) {
            const gForm = document.querySelector('.popup[style] .gform');
            gForm.querySelectorAll('.clone-me').forEach((item) => {
                // Clone it
                let cloned = item.cloneNode(true);
                // Add an increment number to input (so it's unique)
                cloned.querySelectorAll('.form-control').forEach((elm) => {
                    let idAttribute = elm.getAttribute('id');
                    let nameAttribute = elm.getAttribute('name');

                    if(idAttribute){
                        elm.setAttribute('id',  idAttribute.replace(/\d+$/, function(n){ return ++n }));
                        elm.previousElementSibling.setAttribute('for', idAttribute.replace(/\d+$/, function(n){ return ++n }));
                    }
                    if(nameAttribute){
                        elm.setAttribute('name', nameAttribute.replace(/\d+$/, function(n){ return ++n }));
                    }

                });

                // Append
                const lastRow = gForm.querySelector('.row:not(.row-inputs)');
                lastRow.parentNode.insertBefore(cloned,lastRow);

                item.classList.remove('clone-me');
            });
        });

        // Add other communities to track on desktop
        $(document).on('click', '.aside-panel .gform .other-communities-link', function (e) {
            const gForm = document.querySelector('.aside-panel .gform');
            gForm.querySelectorAll('.clone-me').forEach((item) => {
                // Clone it
                let cloned = item.cloneNode(true);
                // Add an increment number to input (so it's unique)
                cloned.querySelectorAll('.form-control').forEach((elm) => {
                    let idAttribute = elm.getAttribute('id');
                    let nameAttribute = elm.getAttribute('name');

                    if(idAttribute){
                        elm.setAttribute('id',  idAttribute.replace(/\d+$/, function(n){ return ++n }));
                        elm.previousElementSibling.setAttribute('for', idAttribute.replace(/\d+$/, function(n){ return ++n }));
                    }
                    if(nameAttribute){
                        elm.setAttribute('name', nameAttribute.replace(/\d+$/, function(n){ return ++n }));
                    }
                });

                // Append
                const lastRow = gForm.querySelector('.row:not(.row-inputs)');
                lastRow.parentNode.insertBefore(cloned,lastRow);

                item.classList.remove('clone-me');
            });
        });

        function formatPhoneField(selector) {
            document.querySelector(selector).addEventListener('input', function (e) {
                var x = e.target.value.replace(/\D/g, '').match(/(\d{0,3})(\d{0,3})(\d{0,4})/);
                e.target.value = !x[2] ? x[1] : x[1] + '-' + x[2] + (x[3] ? '-' + x[3] : '');
            });
        }
        // desktop phone number formatting
        formatPhoneField('.aside-panel .gform #phone');

        // hide popup by button clicking
        for (let i = 0; i < popupButtons.length; i++) {
            popupButtons[i].addEventListener("click", function() {
                if(window.outerWidth < 1025) {
                    document.querySelector('svg > rect:target + foreignObject .popup').style.opacity = '0';
                    //document.querySelector('svg > rect:target + foreignObject + a').scrollIntoView();
                }
            });
        }

        openCloseArea.addEventListener("click", function() {
            asidePanel.classList.add('collapsed');
            document.querySelector('.aside-panel .page-section').style.opacity = '0';
            const dynamicMaskPolygon = document.querySelector('main > svg > mask polygon');
            dynamicMaskPolygon.remove();
        });

        // on mobile, copy aside panel content and remove its form
        $(document).on('click', '.popup[style] .buttons .btn-comm-info', function (e) {
            let commInfoContent = asidePanel.querySelector('.page-section');
            let slideShowContainer = document.querySelector('.popup[style] .slideshow-container');
            let commImage = document.querySelector('.popup[style] img');

            // block body scrolling
            document.body.style.overflow = 'hidden';

            if(commImage) {
                commImage.remove();
            }
            if(slideShowContainer) {
                slideShowContainer.remove();
            }
            document.querySelector('.popup[style] .comm-info').innerHTML = commInfoContent.innerHTML;

            // run ajax script on mobile gform
            loaded();
            // mobile phone number formatting
            formatPhoneField('.popup .gform #phone');
        });

        // toggle aside panel by area clicking
        $(document).on('click', '.bootstrap-select', function (e) {
            let pickedVal = $(this).find('.dropdown-toggle').attr('title');
            window.location.href = '#'+ pickedVal.replace(/ +/g, "");
        });

        // remove style attribute from popup
        $(document).on('click', '.popup[style] .close', function (e) {
            document.querySelectorAll('.popup[style]').forEach(item => {
                item.querySelector('.comm-info').innerHTML='';
                item.removeAttribute('style');
            });

            document.body.removeAttribute('style');
        });

        // refresh aside panel communities dropdown
        for (let i = 0; i < svgLinks.length; i++) {
            svgLinks[i].addEventListener("click", function() {

                // const previousRect = svgLinks[i].previousSibling.previousSibling.previousSibling.previousSibling;
                // const linkId = svgLinks[i].getAttribute('href').split("#")[1];
                // const linkPolygon = svgLinks[i].querySelector('polygon').cloneNode(false);
                // const dynamicMask = document.querySelector('svg > mask');
                //
                // dynamicMask.setAttribute('id',linkId+'Mask');
                // linkPolygon.setAttribute('fill','black');
                // dynamicMask.appendChild(linkPolygon);
                // previousRect.setAttribute('mask','url(#'+linkId+'Mask)');

                asidePanel.classList.remove('collapsed');

                setTimeout(function() {
                    //mapCommunitySelected();
                    document.querySelector('.aside-panel .page-section').style.opacity = '1';
                }, 500);
            });
        }

        // close link in the popup to close aside panel
        for (let i = 0; i < popupCloseLinks.length; i++) {
            popupCloseLinks[i].addEventListener("click", function() {
                asidePanel.classList.add('collapsed');
                document.querySelector('.aside-panel .page-section').style.opacity = '0';
                const dynamicMaskPolygon = document.querySelector('main > svg > mask polygon');
                dynamicMaskPolygon.remove();
            });
        }

        // watch CommunitiesList change to reload it
        // document.querySelector('#CommunitiesList').onchange = function(event) {
        //     if(event.target.value !== 'Communities'){
        //         setTimeout(function() {
        //             mapCommunitySelected();
        //         }, 250);
        //     }
        // }

        // if hash is not empty, display aside panel
        if(hashValue){
            asidePanel.classList.remove('collapsed');
            setTimeout(function() {
                //mapCommunitySelected();
                document.querySelector('.aside-panel .page-section').style.opacity = '1';
                // if(document.documentElement.clientWidth < 1025) {
                //     document.querySelector('svg > rect:target + foreignObject .popup').scrollIntoView();
                // }
            }, 500);
        }

        window.addEventListener('hashchange', function() {
            // setTimeout(function() { slideshow(); }, 500);
            setTimeout(function() { mapCommunitySelected(); mobileSearchCommFilter(); }, 250);

            function watchClickArea(event) {
                if(window.outerWidth < 1025) { // mobile only
                    let popupContainer = document.querySelector('svg > rect:target + foreignObject');
                    if (popupContainer && !popupContainer.contains(event.target)) {
                        // Hide popup
                        document.querySelector('svg > rect:target + foreignObject .popup')
                        // Collapse aside panel
                        asidePanel.classList.add('collapsed');
                        document.querySelector('.aside-panel .page-section').style.opacity = '0';
                        // Remove dynamic mask polygon
                        const dynamicMaskPolygon = document.querySelector('main > svg > mask polygon');
                        dynamicMaskPolygon.remove();
                        // Remove hash values from url
                        window.location.href = '';
                    }
                }
            }

            // Function to set dynamic mask on hash change
            const hashId = window.location.hash.substr(1);
            const dynamicMask = document.querySelector('main > svg > mask')
            const dynamicMaskPolygon = document.querySelector('main > svg > mask polygon');

            // Show or hide the search filter for mobile
            if(hashId){
                document.getElementById('searchCommunitiesFilter').style.display = 'none';

                // Enable clicking outside the popup to close it
                document.addEventListener('mouseup', watchClickArea);

                // Stop glow effect on polygons
                const polygons = document.getElementsByTagName("polygon");
                for (var i = 0; i < polygons.length; i++) {
                    polygons[i].setAttribute("fill", "transparent");
                }
            }
            else {
                document.getElementById('searchCommunitiesFilter').removeAttribute('style');

                // Disable clicking outside the popup to close it
                document.removeEventListener('mouseup', watchClickArea);

                // Start glow effect on polygons
                const polygons = document.getElementsByTagName("polygon");
                for (var i = 0; i < polygons.length; i++) {
                    polygons[i].setAttribute("fill", "white");
                }
            }

            // Scroll into view on mobile
            if(document.documentElement.clientWidth < 1025) {
                const popupActive = document.querySelector('svg > rect:target + foreignObject .popup');
                if(popupActive){
                    popupActive.scrollIntoView();
                }
            }

            // Reset: remove dynamic mask polygon
            if(dynamicMaskPolygon){
                dynamicMaskPolygon.remove();
            }

            // Generate and append dynamic polygon
            document.querySelectorAll('main > svg > a').forEach(item => {
                if(hashId.length && item.getAttribute('href').includes(hashId)){
                    const linkPolygon = item.querySelector('polygon');
                    const linkPolygonClone = linkPolygon.cloneNode(false);
                    const previousRect = item.previousSibling.previousSibling.previousSibling.previousSibling;

                    linkPolygonClone.setAttribute('fill','black');
                    dynamicMask.setAttribute('id',hashId+'Mask');
                    dynamicMask.appendChild(linkPolygonClone);
                    previousRect.setAttribute('mask','url(#'+hashId+'Mask)');
                }
            });
        }, false);

        document.onmouseover = function() { //User's mouse is inside the page.
            window.innerDocClick = true;
        }

        document.onmouseleave = function() { //User's mouse has left the page.
            window.innerDocClick = false;
        }

        window.onhashchange = function() {
            if (!window.innerDocClick) {
                asidePanel.classList.add('collapsed');
                document.querySelector('.aside-panel .page-section').style.opacity = '0';
            }
        }

    }); // DOMContentLoaded

    function mapCommunitySelected() {

        var hash = window.location.hash;
        var hashValue = hash.split('#')[1];
        var communitiesDropdownSelector = document.querySelector('select[name="CommunitiesList"]');
        var communitiesDropdownNotifyMe = document.querySelector('select#notify_me_based_on1');
        var communityNameSelector = document.querySelector('.content-area .page-section .community-name');
        var communityLinksSelector = document.querySelector('.content-area .page-section .community-links');
        var communitySummaryTitleSelector = document.querySelector('.content-area .page-section .community-summary-title');
        var communitySummarySelector = document.querySelector('.content-area .page-section .community-summary');
        var communityDetailsTitleSelector = document.querySelector('.content-area .page-section .community-details-title');
        var communityDetailsSelector = document.querySelector('.content-area .page-section .community-details');
        var communityAdditionalInfoTitleSelector = document.querySelector('.content-area .page-section .community-additional-info-title');
        var communityAdditionalInfoSelector = document.querySelector('.content-area .page-section .community-additional-info');
        var communityPopup = document.querySelector('svg > rect:target + foreignObject .popup');
        var communityPopupPhotos = document.querySelectorAll('svg > rect:target + foreignObject .popup > img');
        var communityPopupCaption = document.querySelector('svg > rect:target + foreignObject .popup .caption');
        var communityPopupCaptionTitle = document.querySelector('svg > rect:target + foreignObject .popup .caption .caption-title');
        var communityPopupButtonsSelector = document.querySelector('svg > rect:target + foreignObject .popup .caption .buttons');

        // if(document.querySelector('svg > rect:target + foreignObject')){
        //     document.querySelector('svg > rect:target + foreignObject').scrollIntoView();
        // }

        var selectedCommunityId = document.querySelector('svg > rect:target');
        var CommunityId, communityDetailsList, communityPhotosList;
        if(selectedCommunityId !== null) {
            CommunityId = document.querySelector('svg > rect:target').getAttribute('id');
        }
        else {
            CommunityId = hashValue;
        }
        var communityIdFormatted = CommunityId;
        if(communityIdFormatted) {
            communityIdFormatted = communityIdFormatted.replace(/([A-Z])/g, ' $1').trim();
        }

        // items to reset
        $('.selectpicker:not([id*="property_for"])').empty();
        <!-- Google Sheets -->
        "use strict";

        getGoogleSheetByEditURL("https://docs.google.com/spreadsheets/d/e/2PACX-1vTQiD-4OVRtVHt9P7dJhrpXFlqx20O31D19UnqLXBqS_Z0QzoLgopGCcG7TggfWzK8gapj2I4tPAGEg/pub?output=csv",
            function thenAfter(contents, didError){
                for (var row=0; row < contents.length; row=row+1|0) { //loop through rows
                    var curRow = contents[row];

                    // populate the Communities dropdown list
                    var ddlEl = document.createElement("option");
                    var ddlEl2 = document.createElement("option");
                    if(curRow[0].startsWith("Community")) {
                        ddlEl.textContent = "Communities";
                        // ddlEl2.textContent = "Communities";
                    }
                    else if (row == 0) {
                        communitiesDropdownNotifyMe.innerHTML = "";
                        ddlEl2.textContent = "Select"
                        ddlEl2.setAttribute("disabled","disabled");
                        ddlEl2.setAttribute("selected","selected");
                        ddlEl2.value = "";
                    }
                    else {
                        ddlEl.textContent = curRow[0];
                        ddlEl2.textContent = curRow[0];
                        ddlEl.value = curRow[0];
                        ddlEl2.value = curRow[0];
                    }
                    communitiesDropdownSelector.appendChild(ddlEl);
                    communitiesDropdownNotifyMe.appendChild(ddlEl2);

                    for (var col=0; col < curRow.length; col=col+1|0) { //loop through cells
                        if(!curRow[col].startsWith("Community")) { // skip the cells that starts with Community word
                            if(curRow[col] == communityIdFormatted) {
                                communityNameSelector.textContent = curRow[col]; // GS Community Name
                                //GS Community Summary
                                if(curRow[col + 1]) {
                                    communitySummarySelector.textContent = curRow[col + 1];
                                    communitySummaryTitleSelector.style.display = 'block';
                                    communitySummarySelector.style.display = 'block';
                                }
                                else {
                                    communitySummaryTitleSelector.style.display = 'none';
                                    communitySummarySelector.style.display = 'none';
                                }
                                //GS Community Details
                                if(curRow[col + 2]) {
                                    communityDetailsList = curRow[col + 2];
                                    communityDetailsTitleSelector.style.display = 'block';
                                    communityDetailsSelector.style.display = 'flex';
                                }
                                else {
                                    communityDetailsTitleSelector.style.display = 'none';
                                    communityDetailsSelector.style.display = 'none';
                                }
                                //GS Community Additional Info
                                if(curRow[col + 3]) {
                                    communityAdditionalInfoSelector.textContent = curRow[col + 3];
                                    communityAdditionalInfoTitleSelector.style.display = 'block';
                                    communityAdditionalInfoSelector.style.display = 'block';
                                }
                                else {
                                    communityAdditionalInfoTitleSelector.style.display = 'none';
                                    communityAdditionalInfoSelector.style.display = 'none';
                                }
                                //GS Community Address
                                if(curRow[col + 4]) {
                                    communityPopupCaption.style.display = 'block';
                                    communityPopupCaptionTitle.textContent = curRow[col + 4];
                                }
                                //GS Community Photos
                                if(curRow[col + 5]) {
                                    communityPhotosList = curRow[col + 5];
                                    communityPopup.style.opacity = '1';
                                }
                                //GS Community Photos is empty
                                else {
                                    if(document.documentElement.clientWidth < 1025) {
                                        communityPopup.classList.add('hide-arrow');
                                        communityPopup.style.opacity = '1';
                                    }
                                    else {
                                        communityPopup.classList.remove('hide-arrow');
                                        communityPopup.style.opacity = '0';
                                    }
                                }
                                // GS Community Links
                                if(curRow[col + 6]) {
                                    var communityLinksList = curRow[col + 6];
                                    if(communityLinksList) {
                                        let tempLinksList;
                                        communityLinksSelector.innerHTML = '';
                                        communityPopupButtonsSelector.innerHTML = '';
                                        communityPopupButtonsSelector.innerHTML += '<li><a class="btn btn-comm-info">Community Info</a></li>';
                                        var communityLinksListElems = communityLinksList.split(";").filter(x => x);
                                        for (var communityLinksListElem in communityLinksListElems) {
                                            tempLinksList = communityLinksListElems[communityLinksListElem].split(/:(.*)/s);
                                            communityLinksSelector.innerHTML += '<li><a href="' + tempLinksList[1] + '">' + tempLinksList[0] + '</a></li>';
                                            communityPopupButtonsSelector.innerHTML += '<li><a href="' + tempLinksList[1] + '" class="btn">' + tempLinksList[0] + '</a></li>';
                                        }
                                    }
                                }

                                // populate community details list
                                if(communityDetailsList) {
                                    let tempDetailsList;
                                    communityDetailsSelector.innerHTML = '';
                                    var communityDetailsListElems = communityDetailsList.split(/:|;/);
                                    for (var communityDetailsListElem in communityDetailsListElems) {
                                        tempDetailsList = communityDetailsListElems[communityDetailsListElem].split(":");
                                        communityDetailsSelector.innerHTML += '<div>' + tempDetailsList[0] + '</div>';
                                    }
                                }

                                // populate community photos
                                for (var i = communityPopupPhotos.length; i-- > 0;){
                                    communityPopupPhotos[i].parentNode.removeChild(communityPopupPhotos[i]);
                                }
                                if(communityPhotosList) {
                                    var communityPhotosListElems = communityPhotosList.split(",");
                                    // slideshow photos to be displayed
                                    if(communityPhotosListElems.length > 1) {
                                        // append slideshow-container
                                        if(!document.querySelectorAll('.slideshow-container').length) {
                                            let slideshowContainer = document.createElement('div');
                                            slideshowContainer.classList.add('slideshow-container');
                                            slideshowContainer.innerHTML = '<a class="prev" onclick="plusSlides(-1)">&#10094;</a><a class="next" onclick="plusSlides(1)">&#10095;</a>';

                                            for(var communityPhotosListElem in communityPhotosListElems){
                                                let slideshowSlide = document.createElement('div');
                                                let newPhoto = document.createElement('img');
                                                slideshowSlide.classList.add('mySlides','fading');
                                                newPhoto.src = communityPhotosListElems[communityPhotosListElem];
                                                newPhoto.setAttribute('alt',curRow[col]);
                                                slideshowSlide.appendChild(newPhoto);
                                                slideshowContainer.appendChild(slideshowSlide);
                                            }
                                            communityPopup.insertBefore(slideshowContainer,communityPopupCaption);
                                        }
                                        showSlides(slideIndex);
                                        // auto scroll photos
                                        var autoscrollInterval = setInterval(autoscrollPhotos, 3000);

                                        function autoscrollPhotos() {
                                            const nextSlidePopup = document.querySelector('svg > rect:target + foreignObject .popup .slideshow-container .next');
                                            if(nextSlidePopup){
                                                nextSlidePopup.click();
                                            }
                                            else {
                                                clearInterval(autoscrollInterval);
                                            }
                                        }
                                    }
                                    // single photo to be displayed
                                    else {
                                        let newPhoto = document.createElement('img');
                                        newPhoto.src = communityPhotosList;
                                        newPhoto.setAttribute('alt',curRow[col]);
                                        communityPopup.insertBefore(newPhoto,communityPopupCaption);
                                    }
                                }
                            }
                        }
                    }
                }
                $('.selectpicker').selectpicker('refresh').trigger('change');
                if (didError) console.log("failed to HTTP get");
            });
        function getGoogleSheetByEditURL(url, then) {
            var xhr = new XMLHttpRequest;
            xhr.open("get", url);
            xhr.responseType = "text";
            xhr.onloadend = function(){
                return then(parseCSV(""||xhr.responseText), !xhr.responseText);
            };
            xhr.timeout = 8192; // assume timeout after 8 seconds
            xhr.send();
        }
        function parseCSV(g){for(var c=[],e=!1,a=0,b=0,f=0;f<g.length;f++){var d=g[f],h=g[f+1];c[a]=c[a]||[];c[a][b]=c[a][b]||"";'"'==d&&e&&'"'==h?(c[a][b]+=d,++f):'"'==d?e=!e:","!=d||e?"\r"!=d||"\n"!=h||e?"\n"!=d||e?"\r"!=d||e?c[a][b]+=d:(++a,b=0):(++a,b=0):(++a,b=0,++f):++b}return c}
        <!-- /Google Sheets -->
    } // /mapCommunitySelected
</script>
</body>
</html>